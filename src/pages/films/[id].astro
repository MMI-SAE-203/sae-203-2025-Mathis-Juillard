---
import { getFilms } from '../../../backend/backend.mjs';
import Layout from '../../layouts/Layout.astro';

const { id } = Astro.params;
const film = await getFilms(id);
if(!film){
    return Astro.redirect('/films');
}
---

<Layout>
  <div class="container mx-auto px-4 py-8">
     <div class="flex flex-col md:flex-row gap-8">
        {film && (
          <>
             <div class="md:w-1/3">
                <img 
                  src={film.posterUrl || "/placeholder-poster.jpg"} 
                  alt={`Affiche du film ${film.title}`} 
                  class="w-full rounded-lg shadow-lg"
                />
             </div>
             <div class="md:w-2/3">
                <h1 class="text-3xl font-bold mb-4">{film.title}</h1>
                <div class="mb-4 text-sm text-gray-500">
                  <span>{film.year}</span>
                  {film.duration && <span> • {film.duration} min</span>}
                  {film.director && <span> • Réalisé par {film.director}</span>}
                </div>
                <div class="mb-6">
                  <h2 class="text-xl font-semibold mb-2">Synopsis</h2>
                  <p>{film.description}</p>
                </div>
                {film.cast && (
                  <div class="mb-6">
                     <h2 class="text-xl font-semibold mb-2">Distribution</h2>
                     <p>{film.cast}</p>
                  </div>
                )}
                {film.genres && (
                  <div class="mb-6">
                     <h2 class="text-xl font-semibold mb-2">Genres</h2>
                     <div class="flex flex-wrap gap-2">
                        {film.genres.map((genre) => (
                          <span class="px-3 py-1 bg-gray-200 rounded-full text-sm">{genre}</span>
                        ))}
                     </div>
                  </div>
                )}
             </div>
          </>
        )}
     </div>
  </div>
</Layout></div>